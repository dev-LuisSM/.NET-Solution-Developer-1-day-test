@{
    ViewBag.Title = "Home Page";
}

<div id="app">
    <h1>My Photo Gallery</h1>

    <div class="gallery"></div>
    <div class="pageNumbers"></div>
</div>

@section scripts{
    <script>

        const photoArray = @Html.Raw(Json.Encode(@Model));
        const gallery = document.querySelector('.gallery');
        const pageNumber = document.querySelector('.pageNumbers');

        let current_page = 1;
        let rows = 100;

        const DisplayList = (items, wrapper, rows_per_page, page) => {
            wrapper.innerHTML = "";
            page--;

            let start = rows_per_page * page;
            let end = start + rows_per_page;
            let paginatedItems = items.slice(start, end);

            for (let i in paginatedItems) {
                let txt = paginatedItems[i].title;
                let imgSrc = paginatedItems[i].thumbnailUrl;

                let picture = document.createElement('picture');
                let thumbnail = document.createElement('img');
                let title = document.createElement('p');
                title.innerText = txt;
                thumbnail.src = imgSrc;

                picture.appendChild(thumbnail);
                picture.appendChild(title);

                wrapper.appendChild(picture);
            }
        };

        const PaginationButton = (page, items) => {
            let button = document.createElement('button');
            button.innerText = page;

            if (current_page == page) button.classList.add('active');
            button.addEventListener('click', function () {
                current_page = page;
                DisplayList(items, gallery, rows, current_page);
                let current_btn = document.querySelector('button.active');
                current_btn.classList.remove('active');

                button.classList.add('active');
            });

            return button;
        }

        const SetupPagination = (items, wrapper, rows_per_page) => {
            wrapper.innerHTML = "";

            let page_count = Math.ceil(items.length / rows_per_page);
            for (let i = 1; i < page_count + 1; i++) {
                let btn = PaginationButton(i, items);
                wrapper.appendChild(btn);
            }
        }

        DisplayList(photoArray, gallery, rows, current_page);
        SetupPagination(photoArray, pageNumber, rows);
    </script>}